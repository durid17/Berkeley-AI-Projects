
<!-- saved from url=(0108)file:///C:/Users/Kristina/Desktop/FreeUni/AI/GEO/Current/Projects/Project%205/Berkeley%20AI%20Materials.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <title>Berkeley AI Materials</title>
  <link rel="stylesheet" href="./ass5_files/project.css" type="text/css" charset="utf-8">
  <link rel="stylesheet" href="./ass5_files/navigation.css" type="text/css" charset="utf-8">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.5.3') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.5.3') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.5.3') format('opentype')}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style></head>
<body><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
  
  <script type="text/javascript" src="./ass5_files/MathJax.js.download">
  </script>
  <div id="content">

    <div class="project">
      <h2 class="project_title">Project 5: Classification</h2>
      <center> Version 1.001. Last Updated: 08/26/2014. </center>
    </div>

    <hr>

    <div class="project">
      <center><table border="0">
        <tbody>
          <tr>
            <td><img alt="" src="./ass5_files/img2.gif"><br> Which Digit?</td>
            <td><img alt="" src="./ass5_files/pacman_multi_agent.png" height="223" width="404"><br>Which action?</td>
          </tr>
        </tbody>
      </table></center>
      <h3><a name="Introduction"></a>Introduction</h3>
      <p>In this project, you will design three classifiers: a perceptron classifier, a large-margin (MIRA) classifier, and a slightly modified perceptron classifier for behavioral cloning. You will test the first two classifiers on a set of scanned handwritten digit images, and the last on sets of recorded pacman games from various agents. Even with simple features, your classifiers will be able to do quite well on these tasks when given enough training data.</p>
      <p>Optical character recognition (<a href="http://en.wikipedia.org/wiki/Optical_character_recognition">OCR</a>) is the task of extracting text from image sources. The data set on which you will run your classifiers is a collection of handwritten numerical digits (0-9). This is a very commercially useful technology, similar to the technique used by the US post office to route mail by zip codes. There are systems that can perform with over 99% classification accuracy (see <a href="http://yann.lecun.com/exdb/lenet/index.html">LeNet-5</a> for an example system in action).</p>
      <p>Behavioral cloning is the task of learning to copy a behavior simply by observing examples of that behavior. In this project, you will be using this idea to mimic various pacman agents by using recorded games as training examples. Your agent will then run the classifier at each action in order to try and determine which action would be taken by the observed agent.</p>
      <p>The code for this project includes the following files and data, available as a <a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/classification.zip">zip file</a>.</p>
      <table class="intro" border="0" cellpadding="10">
        <tbody>
          <tr>
            <td colspan="2"><b>Data file</b></td>
          </tr>
          <tr>
            <td><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/"><code>data.zip</code></a></td>
            <td>Data file, including the digit and face data.</td>
          </tr>
          <tr>
            <td colspan="2"><b>Files you will edit</b></td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/naiveBayes.html">perceptron_pacman.py</a></code></td>
            <td>The location where you will write your behavioral cloning perceptron classifier.</td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/perceptron.html">perceptron.py</a></code></td>
            <td>The location where you will write your perceptron classifier.</td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/mira.html">mira.py</a></code></td>
            <td>The location where you will write your MIRA classifier.</td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/dataClassifier.html">dataClassifier.py</a></code></td>
            <td>The wrapper code that will call your classifiers. You will also write your enhanced feature extractor here. You will also use this code to analyze the behavior of your classifier.</td>
          </tr>
          <!--<tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/minicontest.html">miniContest.py</a></code></td>
            <td>If you decide to enter the miniContest, you will want to edit this file to put in your classifier. Entering the minicontest is optional, but the file must be present in your submission.</td>
          </tr>-->
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/answers.html">answers.py</a></code></td>
            <td>Answer to Question 2 goes here.</td>
          </tr>
          <tr>
            <td colspan="2"><b>Files you should read but NOT edit</b></td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/classificationMethod.html">classificationMethod.py</a></code></td>
            <td>Abstract super class for the classifiers you will write. <br>(You <b>should</b> read this file carefully to see how the infrastructure is set up.)</td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/samples.html">samples.py</a></code></td>
            <td>I/O code to read in the classification data.</td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/util.html">util.py</a></code></td>
            <td>Code defining some useful tools. You may be familiar with some of these by now, and they will save you a lot of time.</td>
          </tr>
          <tr>
            <td><code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/mostFrequent.html">mostFrequent.py</a></code></td>
            <td>A simple baseline classifier that just labels every instance as the most frequent class.</td>
          </tr>
        </tbody>
      </table>
      <p><strong>Files to Edit and Submit:</strong> You will fill in portions of <code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/perceptron.html">perceptron.py</a></code>, <code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/mira.html">mira.py</a></code>, <code><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/answers.html">answers.py</a>,</code><code style="background-color: #ffffff;"><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/perceptron_pacman.html">perceptron_pacman.py</a></code>, and <code style="font-size: 1em; line-height: 1.6em; background-color: #ffffff;"><a href="https://s3-us-west-2.amazonaws.com/cs188websitecontent/projects/release/classification/v1/001/docs/dataClassifier.html">dataClassifier.py</a></code> (only) during the assignment, and submit them. You should submit these files with your code and comments. Please <em>do not</em> change the other files in this distribution or submit any of our original files other than this file.</p>
      <p><strong>Evaluation:</strong> Your code will be autograded for technical correctness. Please <em>do not</em> change the names of any provided functions or classes within the code, or you will wreak havoc on the autograder. However, the correctness of your implementation -- not the autograder's judgements -- will be the final judge of your score. If necessary, we will review and grade assignments individually to ensure that you receive due credit for your work.</p>
      <p><strong>Academic Dishonesty:</strong> We will be checking your code against other submissions in the class for logical redundancy. If you copy someone else's code and submit it with minor changes, we will know. These cheat detectors are quite hard to fool, so please don't try. We trust you all to submit your own work only; <em>please</em> don't let us down. If you do, we will pursue the strongest consequences available to us.</p>
      <p><strong>Getting Help:</strong> You are not alone! If you find yourself stuck on something, contact the course staff for help. Office hours, section, and the discussion forum are there for your support; please use them. If you can't make our office hours, let us know and we will schedule more. We want these projects to be rewarding and instructional, not frustrating and demoralizing. But, we don't know when or how to help unless you ask.</p>
      <p><strong>Discussion:</strong> Please be careful not to post spoilers.</p>
    </div>

    <hr>

    <div class="project">
      <h3><a name="Q1"></a>Question 1 (4 points): Perceptron</h3>
      <p>A skeleton implementation of a perceptron classifier is provided for you in <code>perceptron.py</code>. In this part, you will fill in the <code>train</code> function.</p>
      <p>Unlike the naive Bayes classifier, a perceptron does not use probabilities to make its decisions. Instead, it keeps a weight vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame"><nobr><span class="math" id="MathJax-Span-1" role="math" style="width: 1.524em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.194em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.136em 1000em 1.194em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">w^y</script> of each class <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-6" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">y</script> ( <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame"><nobr><span class="math" id="MathJax-Span-9" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">y</script> is an identifier, not an exponent). Given a feature list <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-12" role="math" style="width: 0.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">f</script>, the perceptron compute the class <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-15" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">y</script> whose weight vector is most similar to the input vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame"><nobr><span class="math" id="MathJax-Span-18" role="math" style="width: 0.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">f</script>. Formally, given a feature vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame"><nobr><span class="math" id="MathJax-Span-21" role="math" style="width: 0.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">f</script> (in our case, a map from pixel locations to indicators of whether they are on), we score each class with:</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-24" role="math" style="width: 11.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.866em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.723em 1000em 3.905em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-25"><span class="mstyle" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mtext" id="MathJax-Span-28" style="font-family: MathJax_Main;">score</span></span></span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="munderover" id="MathJax-Span-35" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Size1; vertical-align: 0.003em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.302em -999.997em); top: -3.105em; left: 0.4em;"><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-40" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.466em;"><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -4.428em; left: 0.731em;"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.634em; left: 0.731em;"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.421em; vertical-align: -1.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8"> \mbox{score}(f,y) = \sum\limits_{i} f_i w^y_i </script></p></div>
      <p>Then we choose the class with highest score as the predicted label for that data instance. In the code, we will represent <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame"><nobr><span class="math" id="MathJax-Span-47" role="math" style="width: 1.524em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.194em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.136em 1000em 1.194em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48"><span class="msubsup" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">w^y</script> as a <code>Counter</code>.</p>
      <h4>Learning weights</h4>
      <p>In the basic multi-class perceptron, we scan over the data, one instance at a time. When we come to an instance <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-52" role="math" style="width: 2.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.252em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.178em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-53"><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">(f, y)</script>, we find the label with highest score:</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame"><nobr><span class="math" id="MathJax-Span-59" role="math" style="width: 13.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.85em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.905em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-60"><span class="msup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">a</span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-68" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.855em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.244em 1000em 4.435em -999.997em); top: -3.237em; left: 0.532em;"><span class="texatom" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="msup" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-74" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">s</span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-83" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.337em; vertical-align: -1.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11"> y' = arg \max\limits_{y''} score(f,y'') </script></p></div>
      <p>We compare <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame"><nobr><span class="math" id="MathJax-Span-87" role="math" style="width: 1.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.069em 1000em 1.392em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-88"><span class="msup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">y'</script> to the true label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame"><nobr><span class="math" id="MathJax-Span-92" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">y</script>. If <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-95" role="math" style="width: 3.376em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.649em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-96"><span class="msup" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">y' = y</script>, we've gotten the instance correct, and we do nothing. Otherwise, we guessed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame"><nobr><span class="math" id="MathJax-Span-102" role="math" style="width: 1.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.069em 1000em 1.392em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-103"><span class="msup" id="MathJax-Span-104"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">y'</script> but we should have guessed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame"><nobr><span class="math" id="MathJax-Span-107" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">y</script>. That means that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-110" role="math" style="width: 1.524em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.194em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.136em 1000em 1.194em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-111"><span class="msubsup" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">w^y</script> should have scored <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame"><nobr><span class="math" id="MathJax-Span-115" role="math" style="width: 0.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">f</script> higher, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame"><nobr><span class="math" id="MathJax-Span-118" role="math" style="width: 1.855em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.458em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(-0.129em 1000em 1.194em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="msup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-126" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">w^{y'}</script> should have scored <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame"><nobr><span class="math" id="MathJax-Span-127" role="math" style="width: 0.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">f</script> lower, in order to prevent this error in the future. We update these two weight vectors accordingly:</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame"><nobr><span class="math" id="MathJax-Span-130" role="math" style="width: 6.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.228em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-131"><span class="msubsup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21"> w^y = w^y + f </script></p></div>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame"><nobr><span class="math" id="MathJax-Span-141" role="math" style="width: 7.278em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.757em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-142"><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="msup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-149" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="msubsup" id="MathJax-Span-151" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="msup" id="MathJax-Span-155"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-157" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.202em;">&#8722;</span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.588em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22"> w^{y'} = w^{y'} - f </script></p></div>

      <p>Using the addition, subtraction, and multiplication functionality of the <code>Counter</code> class in <code>util.py</code>, the perceptron updates should be relatively easy to code. Certain implementation issues have been taken care of for you in <code>perceptron.py</code>, such as handling iterations over the training data and ordering the update trials. Furthermore, the code sets up the <code>weights</code> data structure for you. Each legal label needs its own <code>Counter</code> full of weights.</p>
      <h4>Question</h4>
      <p>Fill in the <code>train</code> method in <code>perceptron.py</code>. Run your code with:</p>
      <pre>python dataClassifier.py -c perceptron </pre>
      <p><strong>Hints and observations:</strong></p>
      <ul>
        <li>The command above should yield validation accuracies in the range between 40% to 70% and test accuracy between 40% and 70% (with the default 3 iterations). These ranges are wide because the perceptron is a lot more sensitive to the specific choice of tie-breaking than naive Bayes.</li>
        <li>One of the problems with the perceptron is that its performance is sensitive to several practical details, such as how many iterations you train it for, and the order you use for the training examples (in practice, using a randomized order works better than a fixed order). The current code uses a default value of 3 training iterations. You can change the number of iterations for the perceptron with the <code>-i iterations</code> option. Try different numbers of iterations and see how it influences the performance. In practice, you would use the performance on the validation set to figure out when to stop training, but you don't need to implement this stopping criterion for this assignment.</li>
      </ul>
    </div>

    <hr>

    <div class="project">
      <h3><a name="Q2"></a>Question 2 (1 point): Perceptron Analysis</h3>
      <h4>Visualizing weights</h4>
      <p>Perceptron classifiers, and other discriminative methods, are often criticized because the parameters they learn are hard to interpret. To see a demonstration of this issue, we can write a function to find features that are characteristic of one class. (Note that, because of the way perceptrons are trained, it is not as crucial to find odds ratios.)</p>
      <h4>Question</h4>
      <p>Fill in <code>findHighWeightFeatures(self, label)</code> in <code>perceptron.py</code>. It should return a list of the 100 features with highest weight for that label. You can display the 100 pixels with the largest weights using the command:</p>
      <pre>python dataClassifier.py -c perceptron -w  </pre>
      <p>Use this command to look at the weights, and answer the following question. Which of the following sequence of weights is most representative of the perceptron?</p>
      <center>
        <table>
          <tbody>
            <tr>
              <td><b>(a)</b></td>
              <td><img alt="" src="./ass5_files/q4a0.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a1.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a2.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a3.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a4.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a5.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a6.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a7.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a8.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4a9.png" height="250" width="75"></td>
            </tr>
            <tr>
              <td><b>(b)</b></td>
              <td><img alt="" src="./ass5_files/q4b0.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b1.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b2.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b3.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b4.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b5.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b6.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b7.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b8.png" height="250" width="75"></td>
              <td><img alt="" src="./ass5_files/q4b9.png" height="250" width="75"></td>
            </tr>
          </tbody>
        </table>
      </center>
      <p>Answer the question <code>answers.py</code> in the method <code>q2</code>, returning either 'a' or 'b'.</p>
    </div>

    <hr>

    <div class="project">
      <h3><a name="Q3"></a>Question 3 (6 points): MIRA</h3>
      <p>A skeleton implementation of the MIRA classifier is provided for you in <code>mira.py</code>. MIRA is an online learner which is closely related to both the support vector machine and perceptron classifiers. You will fill in the <code>trainAndTune</code> function.</p>
      <h4>Theory</h4>
      <p>Similar to a multi-class perceptron classifier, multi-class MIRA classifier also keeps a weight vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame"><nobr><span class="math" id="MathJax-Span-160" role="math" style="width: 1.524em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.194em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.136em 1000em 1.194em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-161"><span class="msubsup" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">w^y</script> of each label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame"><nobr><span class="math" id="MathJax-Span-165" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">y</script>. We also scan over the data, one instance at a time. When we come to an instance <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame"><nobr><span class="math" id="MathJax-Span-168" role="math" style="width: 2.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.252em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.178em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-169"><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">(f, y)</script>, we find the label with highest score:</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame"><nobr><span class="math" id="MathJax-Span-175" role="math" style="width: 13.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.85em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.905em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-176"><span class="msup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">a</span><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-184" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.855em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.244em 1000em 4.435em -999.997em); top: -3.237em; left: 0.532em;"><span class="texatom" id="MathJax-Span-186"><span class="mrow" id="MathJax-Span-187"><span class="msup" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-190" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">s</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-199" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.337em; vertical-align: -1.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26"> y' = arg \max\limits_{y''} score(f,y'') </script></p></div>
      <p>We compare <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame"><nobr><span class="math" id="MathJax-Span-203" role="math" style="width: 1.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.069em 1000em 1.392em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-204"><span class="msup" id="MathJax-Span-205"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">y'</script> to the true label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame"><nobr><span class="math" id="MathJax-Span-208" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">y</script>. If <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame"><nobr><span class="math" id="MathJax-Span-211" role="math" style="width: 3.376em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.649em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-212"><span class="msup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">y' = y</script>, we've gotten the instance correct, and we do nothing. Otherwise, we guessed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame"><nobr><span class="math" id="MathJax-Span-218" role="math" style="width: 1.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.069em 1000em 1.392em -999.997em); top: -0.989em; left: 0.003em;"><span class="mrow" id="MathJax-Span-219"><span class="msup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.995em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">y'</script> but we should have guessed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame"><nobr><span class="math" id="MathJax-Span-223" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.913em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">y</script>. Unlike the perceptron, we update the weight vectors of these labels with a variable step size:</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame"><nobr><span class="math" id="MathJax-Span-226" role="math" style="width: 7.278em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.757em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-227"><span class="msubsup" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="msubsup" id="MathJax-Span-232" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32"> w^y = w^y + \tau f </script></p></div>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame"><nobr><span class="math" id="MathJax-Span-238" role="math" style="width: 7.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.286em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-239"><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="msup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-246" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="msubsup" id="MathJax-Span-248" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="msup" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-254" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.202em;">&#8722;</span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.588em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33"> w^{y'} = w^{y'} - \tau f </script></p></div>
      <p>where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame"><nobr><span class="math" id="MathJax-Span-258" role="math" style="width: 2.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.318em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.046em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="mn" id="MathJax-Span-262" style="font-family: MathJax_Main; padding-left: 0.268em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.171em; vertical-align: -0.246em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34"> \tau \geq 0 </script> is chosen such that it minimizes</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame"><nobr><span class="math" id="MathJax-Span-263" role="math" style="width: 12.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.924em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 3.839em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-264"><span class="munderover" id="MathJax-Span-265"><span style="display: inline-block; position: relative; width: 1.657em; height: 0px;"><span style="position: absolute; clip: rect(3.112em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.244em 1000em 4.302em -999.997em); top: -3.237em; left: 0.466em;"><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="msup" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="mo" id="MathJax-Span-271" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-272" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 0.466em; height: 0px; margin-right: 0.136em; margin-left: 0.136em;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -4.428em; left: 50%; margin-left: -0.195em;"><span class="mn" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.195em;"><span class="mn" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(0.797em 1000em 1.26em -999.997em); top: -1.253em; left: 0.003em;"><span style="border-left-width: 0.466em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.062em;"></span></span></span></span><span class="munderover" id="MathJax-Span-275" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Size1; vertical-align: 0.003em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.105em; left: 0.4em;"><span class="texatom" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="texatom" id="MathJax-Span-280" style="padding-left: 0.202em;"><span class="mrow" id="MathJax-Span-281"><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-283"><span class="mrow" id="MathJax-Span-284"><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mo" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.4em;"><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main; padding-left: 0.202em;">&#8722;</span><span class="msubsup" id="MathJax-Span-294" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="texatom" id="MathJax-Span-297"><span class="mrow" id="MathJax-Span-298"><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="texatom" id="MathJax-Span-301"><span class="mrow" id="MathJax-Span-302"><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -4.428em; left: 0.268em;"><span class="mn" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.7em; left: 0.268em;"><span class="mn" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.587em; vertical-align: -1.246em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35"> \min\limits_{w'} \frac{1}{2} \sum\limits_{c} ||(w')^c - w^c ||_2^2 </script></p></div>
      <div><p>subject to the condition that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame"><nobr><span class="math" id="MathJax-Span-306" role="math" style="width: 10.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.667em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 3.178em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-307"><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mo" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.4em;"><span class="mi" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.268em;">(</span><span class="msup" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mo" id="MathJax-Span-320" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-321"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.4em;"><span class="texatom" id="MathJax-Span-323"><span class="mrow" id="MathJax-Span-324"><span class="msup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-327" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-330" style="font-family: MathJax_Main; padding-left: 0.202em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.671em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">(w')^y f \geq (w')^{y'} f + 1 </script></p></div>
      <p><br> which is equivalent to</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame"><nobr><span class="math" id="MathJax-Span-331" role="math" style="width: 5.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.435em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 3.641em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-332"><span class="munderover" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 1.657em; height: 0px;"><span style="position: absolute; clip: rect(3.112em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-334" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.37em; left: 0.665em;"><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="texatom" id="MathJax-Span-338" style="padding-left: 0.202em;"><span class="mrow" id="MathJax-Span-339"><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-341"><span class="mrow" id="MathJax-Span-342"><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="texatom" id="MathJax-Span-346"><span class="mrow" id="MathJax-Span-347"><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1000em 4.435em -999.997em); top: -3.965em; left: 0.003em;"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -4.428em; left: 0.268em;"><span class="mn" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.7em; left: 0.268em;"><span class="mn" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.254em; vertical-align: -0.996em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37"> \min\limits_{\tau} ||\tau f ||_2^2 </script> subject to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame"><nobr><span class="math" id="MathJax-Span-355" role="math" style="width: 8.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.485em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.194em 1000em 3.707em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="mfrac" id="MathJax-Span-359" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 4.368em; height: 0px; margin-right: 0.136em; margin-left: 0.136em;"><span style="position: absolute; clip: rect(3.046em 1000em 4.368em -999.997em); top: -4.56em; left: 50%; margin-left: -2.113em;"><span class="mrow" id="MathJax-Span-360"><span class="mo" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-362"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="texatom" id="MathJax-Span-364"><span class="mrow" id="MathJax-Span-365"><span class="msup" id="MathJax-Span-366"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.509em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-367" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.163em; left: 0.334em;"><span class="mo" id="MathJax-Span-368" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-369" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="msubsup" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="mi" id="MathJax-Span-372" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.112em 1000em 4.368em -999.997em); top: -3.37em; left: 50%; margin-left: -0.923em;"><span class="mrow" id="MathJax-Span-377"><span class="mn" id="MathJax-Span-378" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="mo" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mo" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="texatom" id="MathJax-Span-386"><span class="mrow" id="MathJax-Span-387"><span class="mo" id="MathJax-Span-388" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-389"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.244em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="texatom" id="MathJax-Span-390"><span class="mrow" id="MathJax-Span-391"><span class="mo" id="MathJax-Span-392" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -4.296em; left: 0.202em;"><span class="mn" id="MathJax-Span-393" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.767em; left: 0.202em;"><span class="mn" id="MathJax-Span-394" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(0.797em 1000em 1.26em -999.997em); top: -1.253em; left: 0.003em;"><span style="border-left-width: 4.368em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.062em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.921em; vertical-align: -1.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38"> \tau \geq \frac{(w^{y'} - w^y)f + 1}{2 ||f||_2^2} </script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame"><nobr><span class="math" id="MathJax-Span-395" role="math" style="width: 2.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.318em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.046em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-396"><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="mn" id="MathJax-Span-399" style="font-family: MathJax_Main; padding-left: 0.268em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.171em; vertical-align: -0.246em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39"> \tau \geq 0 </script></p></div>
      <p>Note that, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame"><nobr><span class="math" id="MathJax-Span-400" role="math" style="width: 6.286em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.964em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.591em 1000em 3.112em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-401"><span class="msubsup" id="MathJax-Span-402"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="texatom" id="MathJax-Span-404"><span class="mrow" id="MathJax-Span-405"><span class="msup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-408" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="msubsup" id="MathJax-Span-411" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 1.128em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.731em;"><span class="mi" id="MathJax-Span-413" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.588em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">w^{y'}f \geq w^y f </script>, so the condition <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame"><nobr><span class="math" id="MathJax-Span-415" role="math" style="width: 2.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.318em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.046em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="mn" id="MathJax-Span-419" style="font-family: MathJax_Main; padding-left: 0.268em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.171em; vertical-align: -0.246em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41"> \tau \geq 0 </script> is always true given <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame"><nobr><span class="math" id="MathJax-Span-420" role="math" style="width: 8.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.485em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.194em 1000em 3.707em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main; padding-left: 0.268em;">&#8805;</span><span class="mfrac" id="MathJax-Span-424" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 4.368em; height: 0px; margin-right: 0.136em; margin-left: 0.136em;"><span style="position: absolute; clip: rect(3.046em 1000em 4.368em -999.997em); top: -4.56em; left: 50%; margin-left: -2.113em;"><span class="mrow" id="MathJax-Span-425"><span class="mo" id="MathJax-Span-426" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-427"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="texatom" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="msup" id="MathJax-Span-431"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.509em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-432" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.163em; left: 0.334em;"><span class="mo" id="MathJax-Span-433" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="mi" id="MathJax-Span-437" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-439" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.112em 1000em 4.368em -999.997em); top: -3.37em; left: 50%; margin-left: -0.923em;"><span class="mrow" id="MathJax-Span-442"><span class="mn" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mo" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="mo" id="MathJax-Span-449" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="texatom" id="MathJax-Span-451"><span class="mrow" id="MathJax-Span-452"><span class="mo" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.244em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="texatom" id="MathJax-Span-455"><span class="mrow" id="MathJax-Span-456"><span class="mo" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -4.296em; left: 0.202em;"><span class="mn" id="MathJax-Span-458" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.767em; left: 0.202em;"><span class="mn" id="MathJax-Span-459" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(0.797em 1000em 1.26em -999.997em); top: -1.253em; left: 0.003em;"><span style="border-left-width: 4.368em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.062em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.921em; vertical-align: -1.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42"> \tau \geq \frac{(w^{y'} - w^y)f + 1}{2 ||f||_2^2} </script> Solving this simple problem, we then have</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame"><nobr><span class="math" id="MathJax-Span-460" role="math" style="width: 8.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.485em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.194em 1000em 3.707em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-461"><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mfrac" id="MathJax-Span-464" style="padding-left: 0.268em;"><span style="display: inline-block; position: relative; width: 4.368em; height: 0px; margin-right: 0.136em; margin-left: 0.136em;"><span style="position: absolute; clip: rect(3.046em 1000em 4.368em -999.997em); top: -4.56em; left: 50%; margin-left: -2.113em;"><span class="mrow" id="MathJax-Span-465"><span class="mo" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="texatom" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="msup" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.509em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-472" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.163em; left: 0.334em;"><span class="mo" id="MathJax-Span-473" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="mi" id="MathJax-Span-477" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.112em 1000em 4.368em -999.997em); top: -3.37em; left: 50%; margin-left: -0.923em;"><span class="mrow" id="MathJax-Span-482"><span class="mn" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="mo" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="texatom" id="MathJax-Span-491"><span class="mrow" id="MathJax-Span-492"><span class="mo" id="MathJax-Span-493" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.244em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="texatom" id="MathJax-Span-495"><span class="mrow" id="MathJax-Span-496"><span class="mo" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -4.296em; left: 0.202em;"><span class="mn" id="MathJax-Span-498" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.767em; left: 0.202em;"><span class="mn" id="MathJax-Span-499" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(0.797em 1000em 1.26em -999.997em); top: -1.253em; left: 0.003em;"><span style="border-left-width: 4.368em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.062em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.921em; vertical-align: -1.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43"> \tau = \frac{(w^{y'} - w^y)f + 1}{2||f||_2^2} </script></p></div>
      <p>However, we would like to cap the maximum possible value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame"><nobr><span class="math" id="MathJax-Span-500" role="math" style="width: 0.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.855em 1000em 2.715em -999.997em); top: -2.51em; left: 0.003em;"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.517em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.754em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44"> \tau </script> by a positive constant C, which leads us to</p>
      <div><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame"><nobr><span class="math" id="MathJax-Span-503" role="math" style="width: 12.834em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.188em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.194em 1000em 3.707em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.268em;">min</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-511" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 4.368em; height: 0px; margin-right: 0.136em; margin-left: 0.136em;"><span style="position: absolute; clip: rect(3.046em 1000em 4.368em -999.997em); top: -4.56em; left: 50%; margin-left: -2.113em;"><span class="mrow" id="MathJax-Span-512"><span class="mo" id="MathJax-Span-513" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-514"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="texatom" id="MathJax-Span-516"><span class="mrow" id="MathJax-Span-517"><span class="msup" id="MathJax-Span-518"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.509em 1000em 4.302em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-519" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.163em; left: 0.334em;"><span class="mo" id="MathJax-Span-520" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="msubsup" id="MathJax-Span-522"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.532em;"><span class="mi" id="MathJax-Span-524" style="font-size: 52.9%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-525" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-527" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-528" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.112em 1000em 4.368em -999.997em); top: -3.37em; left: 50%; margin-left: -0.923em;"><span class="mrow" id="MathJax-Span-529"><span class="mn" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-531"><span class="mrow" id="MathJax-Span-532"><span class="mo" id="MathJax-Span-533" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="mo" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="texatom" id="MathJax-Span-538"><span class="mrow" id="MathJax-Span-539"><span class="mo" id="MathJax-Span-540" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-541"><span style="display: inline-block; position: relative; width: 0.532em; height: 0px;"><span style="position: absolute; clip: rect(3.244em 1000em 4.368em -999.997em); top: -3.965em; left: 0.003em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mo" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -4.296em; left: 0.202em;"><span class="mn" id="MathJax-Span-545" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.767em; left: 0.202em;"><span class="mn" id="MathJax-Span-546" style="font-size: 52.9%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(0.797em 1000em 1.26em -999.997em); top: -1.253em; left: 0.003em;"><span style="border-left-width: 4.368em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.062em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.921em; vertical-align: -1.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45"> \tau = \min ( C, \frac{(w^{y'} - w^y)f + 1}{2||f||_2^2} ) </script></p></div>
      <h4>Question</h4>
      <p>Implement <code>trainAndTune</code> in <code>mira.py</code>. This method should train a MIRA classifier using each value of <em>C</em> in <code>Cgrid</code>. Evaluate accuracy on the held-out validation set for each <em>C</em> and choose the <em>C</em> with the highest validation accuracy. In case of ties, prefer the <em>lowest</em> value of <em>C</em>. Test your MIRA implementation with:</p>
      <pre>python dataClassifier.py -c mira --autotune </pre>
      <p><strong>Hints and observations:</strong></p>
      <ul>
        <li>Pass through the data <code>self.max_iterations</code> times during training.</li>
        <li>Store the weights learned using the best value of <em>C</em> at the end in <code>self.weights</code>, so that these weights can be used to test your classifier.</li>
        <li>To use a fixed value of <em>C=0.001</em>, remove the <code>--autotune</code> option from the command above.</li>
        <li>Validation and test accuracy when using <code>--autotune</code> should be around the 60's.</li>
        <li>It might save some debugging time if the +1 term above is implemented as +1.0, due to division truncation of integer arguments. Depending on how you implement this, it may not matter.</li>
        <li>The same code for returning high odds features in your perceptron implementation should also work for MIRA if you're curious what your classifier is learning.</li>
      </ul>
    </div>

    <hr>

    <div class="project">
      <h3><a name="Q4"></a>Question 4 (6 points): Digit Feature Design</h3>
      <p>Building classifiers is only a small part of getting a good system working for a task. Indeed, the main difference between a good classification system and a bad one is usually not the classifier itself (e.g. perceptron vs. naive Bayes), but rather the quality of the features used. So far, we have used the simplest possible features: the identity of each pixel (being on/off).</p>
      <p>To increase your classifier's accuracy further, you will need to extract more useful features from the data. The <code>EnhancedFeatureExtractorDigit</code> in <code>dataClassifier.py</code> is your new playground. When analyzing your classifiers' results, you should look at some of your errors and look for characteristics of the input that would give the classifier useful information about the label. You can add code to the <code>analysis</code> function in <code>dataClassifier.py</code> to inspect what your classifier is doing. For instance in the digit data, consider the number of separate, connected regions of white pixels, which varies by digit type. 1, 2, 3, 5, 7 tend to have one contiguous region of white space while the loops in 6, 8, 9 create more. The number of white regions in a 4 depends on the writer. This is an example of a feature that is not directly available to the classifier from the per-pixel information. If your feature extractor adds new features that encode these properties, the classifier will be able exploit them. Note that some features may require non-trivial computation to extract, so write efficient and correct code.</p>
      <p><em>Note: You will be working with digits, so make sure you are using </em><i>DIGIT_DATUM_WIDTH and </i><i>DIGIT_DATUM_HEIGHT, instead of FACE_DATUM_WIDTH and FACE_DATUM_HEIGHT.</i></p>
      <h4>Question</h4>
      <p>Add new binary features for the digit dataset in the <code>EnhancedFeatureExtractorDigit</code> function. Note that you can encode a feature which takes 3 values [1,2,3] by using 3 binary features, of which only one is on at the time, to indicate which of the three possibilities you have. In theory, features aren't conditionally independent as naive Bayes requires, but your classifier can still work well in practice. We will test your classifier with the following command:</p>
      <pre>python dataClassifier.py -d digits -c naiveBayes -f -a -t 1000  </pre>
      <p>With the basic features (without the <code>-f</code> option), your optimal choice of smoothing parameter should yield 82% on the validation set with a test performance of 78%. You will receive 3 points for implementing new feature(s) which yield any improvement at all. You will receive 3 additional points if your new feature(s) give you a test performance greater than or equal to 84% with the above command.</p>
    </div>

    <hr>

    <div class="project">
      <h3><a name="Q5"></a>Question 5 (4 points): Behavioral Cloning</h3>
      <p>You have built two different types of classifiers, a perceptron classifier and mira. You will now use a modified version of perceptron in order to learn from pacman agents. In this question, you will fill in the classify and train methods in <code>perceptron_pacman.py</code>. This code should be similar to the methods you've written in <code>perceptron.py.</code></p>
      <p>For this application of classifiers, the data will be states, and the labels for a state will be all legal actions possible from that state. Unlike perceptron for digits, all of the labels share a single weight vector w, and the features extracted are a function of both the state and possible label.</p>
      <p>For each action, calculate the score as follows:</p>
      <div>
        <p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame"><nobr><span class="math" id="MathJax-Span-548" role="math" style="width: 12.768em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.122em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.178em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-549"><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-558" style="font-family: MathJax_Main; padding-left: 0.202em;">a</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">w</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main; padding-left: 0.202em;">&#8727;</span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">score(s, \text{a}) = w*f(s,a)</script></p>
      </div>
      <p>Then the classifier assigns whichever label receives the highest score:</p>
      <div>
        <p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame"><nobr><span class="math" id="MathJax-Span-569" role="math" style="width: 13.495em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.718em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.773em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-570"><span class="msup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-575" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">a</span><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-578" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.855em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.244em 1000em 4.302em -999.997em); top: -3.237em; left: 0.599em;"><span class="texatom" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="msup" id="MathJax-Span-582"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px;"><span style="position: absolute; clip: rect(3.442em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.229em; left: 0.4em;"><span class="mo" id="MathJax-Span-584" style="font-size: 52.9%; font-family: MathJax_Main;">&#8242;&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mi" id="MathJax-Span-585" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">s</span><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-588" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-593" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.171em; vertical-align: -1.162em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">a' = arg \max\limits_{a''} score (s,a'')</script></p>
      </div>
      <p>Training updates occur in much the same way that they do for the standard classifiers. Instead of modifying two separate weight vectors on each update, the weights for the actual and predicted labels, both updates occur on the shared weights as follows:</p>
      <div>
        <p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame"><nobr><span class="math" id="MathJax-Span-597" role="math" style="width: 8.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.617em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.178em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-598"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">w</span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">w= w+ f(s,a)</script> # Correct action</p>
        <p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame"><nobr><span class="math" id="MathJax-Span-609" role="math" style="width: 8.667em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.882em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.789em 1000em 3.178em -999.997em); top: -2.708em; left: 0.003em;"><span class="mrow" id="MathJax-Span-610"><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.268em;">=</span><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic; padding-left: 0.268em;">w</span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main; padding-left: 0.202em;">&#8722;</span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.069em;"></span></span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-619" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 0.797em; height: 0px;"><span style="position: absolute; clip: rect(3.31em 1000em 4.17em -999.997em); top: -3.965em; left: 0.003em;"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -4.296em; left: 0.532em;"><span class="mo" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Main;">&#8242;</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.715em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.421em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">w= w- f(s,a')</script> # Guessed action</p>
      </div>
      <h4>Question</h4>
      <p>Fill in the  <code>train</code> method in <code>perceptron_pacman.py</code>. Run your code with:</p>
      <p><code>python dataClassifier.py -c perceptron -d pacman</code></p>
      <p>This command should yield validation and test accuracy of over 70%.</p>
    </div>

    <hr>

    <div class="project">
      <h3><a name="Q6"></a>Question 6 (4 points): Pacman Feature Design</h3>
      <p>In this part you will write your own features in order to allow the classifier agent to clone the behavior of observed agents. We have provided several agents for you to try to copy behavior from:</p>
      <ul>
        <li><strong>StopAgent</strong>: An agent that only stops</li>
        <li><strong>FoodAgent</strong>: An agent that only aims to eat the food, not caring about anything else in the environment.</li>
        <li><strong>SuicideAgent</strong>: An agent that only moves towards the closest ghost, regardless of whether it is scared or not scared.</li>
        <li><strong>ContestAgent</strong>: A staff agent from p2 that smartly avoids ghosts, eats power capsules and food.</li>
      </ul>
      <p>We've placed files containing multiple recorded games for each agent in the data/pacmandata directory. Each agent has 15 games recorded and saved for training data, and 10 games for both validation and testing.</p>
      <h4>Question</h4>
      <p>Add new features for behavioral cloning in the <code>EnhancedPacmanFeatures</code> function in <code>dataClassifier.py</code>. </p>
      <p>Upon completing your features, you should get at least 90% accuracy on the ContestAgent, and 80% on each of the other 3 provided agents. You can directly test this using the <code>--agentToClone &lt;Agent name&gt;, -g &lt;Agent name&gt;</code> option for dataClassifier.py:</p>
      <p><code>python dataClassifier.py -c perceptron -d pacman -f -g ContestAgent -t 1000 -s 1000</code></p>
      <h4>Other helpful options:</h4>
      <p>We have also provided a new ClassifierAgent, in pacmanAgents.py, for you that uses your implementation of perceptron_pacman. This agent takes in training, and optionally validation, data and performs the training step of the classifier upon initialization. Then each time it makes an action it runs the trained classifier on the state and performs the returned action. You can run this agent with the following command:</p>
      <p><code>python pacman.py -p ClassifierAgent --agentArgs trainingData=&lt;path to training data&gt;</code></p>
      <p>You can also use the <code>--agentToClone &lt;Agent Name&gt;</code> option to use one of the four agents specified above to train on:</p>
      <p><code>python pacman.py -p ClassifierAgent --agentArgs agentToClone=&lt;Agent Name&gt;</code></p>
      <p><em>Congratulations! You're finished with the CS 188 projects.</em></p>
    </div>

    <hr>

    <h3>Submission</h3>
    <p>You're not done yet! Follow your instructor's guidelines to receive credit on your project!</p>

  </div>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_AMS, monospace;"></div></div></body></html>